<!doctype html>
<html lang="en-us">
  <head>
    <title>ADR &#34;Best Practice&#34; // DaltonFarm0</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Chris Dalton" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ADR &#34;Best Practice&#34;">
  <meta name="twitter:description" content="The 95% Solution: How to Actually Setup Your ADRs Someone recently asked me what’s the best way to setup ADRs (Automatic Deployment Rules). So, I’m going to run through a quick post on what I configure in 95% of the environments I manage.
There are always exceptions, but the following setup is likely what I would deploy in almost any environment.
The Strategy You are going to build 4 different ADRs.">

    <meta property="og:url" content="https://ckdalton01.github.io/blog/adrbestpractice/">
  <meta property="og:site_name" content="DaltonFarm0">
  <meta property="og:title" content="ADR &#34;Best Practice&#34;">
  <meta property="og:description" content="The 95% Solution: How to Actually Setup Your ADRs Someone recently asked me what’s the best way to setup ADRs (Automatic Deployment Rules). So, I’m going to run through a quick post on what I configure in 95% of the environments I manage.
There are always exceptions, but the following setup is likely what I would deploy in almost any environment.
The Strategy You are going to build 4 different ADRs.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-12-29T19:44:28-07:00">
    <meta property="article:modified_time" content="2025-12-29T19:44:28-07:00">
    <meta property="article:tag" content="ConfigMgr">
    <meta property="article:tag" content="ADR">
    <meta property="article:tag" content="SoftwareUpdates">


  </head>
  <body>
    <header class="app-header">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Chris Dalton" /></a>
      <span class="app-header-title">DaltonFarm0</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             -- 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
             -- 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p>Professional Log Reader, amature at everything else.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/ckdalton01" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="https://www.linkedin.com/in/christopher-dalton-552a2955" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-linkedin" viewBox="0 0 24 24" fill="currentColor"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">ADR &#34;Best Practice&#34;</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Dec 29, 2025
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          7 min read
        </div>
        <div>
          <svg class="icon icon-tag" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
              <a class="tag" href="/tags/configmgr/">ConfigMgr</a>
              <a class="tag" href="/tags/adr/">ADR</a>
              <a class="tag" href="/tags/softwareupdates/">SoftwareUpdates</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="the-95-solution-how-to-actually-setup-your-adrs">The 95% Solution: How to Actually Setup Your ADRs</h1>
<p>Someone recently asked me what&rsquo;s the <em>best</em> way to setup ADRs (Automatic Deployment Rules). So, I&rsquo;m going to run through a quick post on what I configure in 95% of the environments I manage.</p>
<p>There are always exceptions, but the following setup is likely what I would deploy in almost any environment.</p>
<h2 id="the-strategy">The Strategy</h2>
<p>You are going to build <strong>4 different ADRs</strong>.</p>
<p>I&rsquo;ve had conversations with people I respect greatly in the Endpoint Management space, and we agree on the majority of the config here. Sure, there are environments where something different is needed, but setting these up correctly is key.</p>
<p>We need to discuss a couple of things first:</p>
<ul>
<li><strong>What</strong> updates get applied (OS, Defender definition updates, third-party).</li>
<li><strong>When</strong> updates get applied (Maintenance windows, update rings, etc.).</li>
<li><strong>How often</strong> you should Sync (ADR run vs. SUP Sync).</li>
<li><strong>Why?</strong> (The most important part).</li>
</ul>
<h3 id="global-settings">Global Settings</h3>
<p>At a minimum, sync your SUP <strong>daily</strong>, but I&rsquo;d recommend every <strong>8 hours</strong>.</p>
<hr>
<h2 id="1-windows-updates">1. Windows Updates</h2>
<p><strong>Scope:</strong> OS updates, .NET framework, and whatever else is typically added on &ldquo;Patch Tuesday.&rdquo;</p>
<h3 id="the-rings-when">The Rings (When)</h3>
<p>Split this into 3 different groups:</p>
<ol>
<li><strong>Test</strong> - All Devices (0 day delay)</li>
<li><strong>Broad</strong> - All Devices (3 day delay)</li>
<li><strong>Production</strong> - All Devices (7 day delay)</li>
</ol>
<ul>
<li><strong>Server collections:</strong> Must adhere to maintenance windows (if needed).
<ul>
<li>Create maintence windows in other collections: Test - Server, Broad - Server, Prod - Server</li>
<li>Add maintence windows to these and nest them in the patching collections.</li>
</ul>
</li>
<li><strong>Workstation collections:</strong> Generally shouldn&rsquo;t need maintenance windows.</li>
</ul>
<h3 id="frequency">Frequency</h3>
<p><strong>Run the ADR: Daily.</strong>
Generally, MS only sends updates on &ldquo;Patch Tuesday.&rdquo; However, Out-of-Band (OOB) patches do happen. These are usually critical, so they should be applied ASAP anyway, while still going through your update rings.</p>
<h3 id="the-why">The &ldquo;Why&rdquo;</h3>
<p>OS Updates generally require a reboot (although MS is looking to do away with this for some updates). These can be inconvenient for some companies, but good news: it happens once a month (usually, unless it&rsquo;s an OOB update).</p>
<h3 id="additional-settings">Additional settings</h3>
<p>Here we are going to add the &gt;=1 for Required, it&rsquo;s very likely that the overwhelming majority of your fleet is the same OS. Once one device checks in with ConfigMgr and scans updates, it will report back it needs the update. The update will then get added to the Software Update Group and get deployed.
This setting prevents your ConfigMgr environment from downloading <em>all</em> Patch Tuesday Updates</p>
<p><img src="/2026-01-05_07-40-44.PNG" alt="Image"></p>
<blockquote>
<p><strong>Where I see people go wrong:</strong>
Creating multiple ADRs for servers and workstations is <strong>not required</strong>. Sending server updates to workstations will show as &rsquo;not required&rsquo; and the client will simply pass on the installation.
People over-complicate things by creating multiple ADRs for different collections. At best, this leads to multiple ADRs requiring modification. At worst, you get different patches hitting Test vs. Production. Keep it simple.</p>
</blockquote>
<hr>
<h2 id="2-office-updates">2. Office Updates</h2>
<p><strong>Scope:</strong> O365 updates, etc.</p>
<h3 id="the-rings-when-1">The Rings (When)</h3>
<p>Split this into 3 different groups:</p>
<ol>
<li><strong>Test</strong> - All Devices (0 day delay)</li>
<li><strong>Broad</strong> - All Devices (3 day delay)</li>
<li><strong>Production</strong> - All Devices (7 day delay)</li>
</ol>
<ul>
<li><strong>Server collections:</strong> Should adhere to maintenance windows (if needed).</li>
<li><em>Note:</em> Remember those maintenance windows that were created in your server collections above? If a device has a maintenance window applied to it in another collection, it will still adhere to it here.</li>
</ul>
<h3 id="frequency-1">Frequency</h3>
<p><strong>Run the ADR: Daily.</strong>
Same logic as above—usually Patch Tuesday, but if OOB patches hit, you want them moving through your rings immediately.</p>
<h3 id="the-why-1">The &ldquo;Why&rdquo;</h3>
<p>These tend to fail the download more than any other updates. They can cause errors, and if these error out, you usually just need to try troubleshooting or syncing again.</p>
<h3 id="additional-settings-1">Additional settings</h3>
<p>This one can be tricky, either add the &gt;=1 requirement or consider adding a title filter for the channel of updates you use in your environment.</p>
<blockquote>
<p><strong>Where I see people go wrong:</strong>
&ldquo;Why not package these with the OS updates?&rdquo;
Because the failures can cause the <strong>entire ADR to fail</strong>. When an ADR fails, you have to dig through the logs, etc. If it&rsquo;s just Office updates, it&rsquo;s likely failing the CDN Download. If they are separate, you can just rerun it, and it should be fine without holding up your OS security patches.</p>
</blockquote>
<hr>
<h2 id="3-defender-updates">3. Defender Updates</h2>
<p><strong>Scope:</strong> Defender definitions (if applicable—let&rsquo;s be honest, your EDR solution is doing this already unless you are using Defender).</p>
<h3 id="the-rings-when-2">The Rings (When)</h3>
<p>Split this into 3 groups:</p>
<ol>
<li><strong>Test</strong> - All Devices (0 hour delay)</li>
<li><strong>Broad</strong> - All Devices (2 hour delay)</li>
<li><strong>Production</strong> - All Devices (4 hour delay)</li>
</ol>
<p><strong>Maintenance Windows:</strong> None. Zero. Send to everyone daily.</p>
<ul>
<li><em>However</em>, I&rsquo;d still test with about a <strong>~4 hour delay</strong> into Prod. Remember CrowdStrike?</li>
<li><strong>Force the deployment to override the maintenance window here.</strong></li>
</ul>
<h3 id="frequency-2">Frequency</h3>
<p><strong>Run the ADR: Every 8 hours.</strong>
Generally, MS sends updates every 8 hours. You should pick them up and send them all the time.</p>
<h3 id="the-why-2">The &ldquo;Why&rdquo;</h3>
<p>These need to go out daily. They will get added in the background and the users will never be interrupted for this. It&rsquo;s better to be aggressive here as they do not cause reboots.</p>
<h3 id="additional-settings-2">Additional settings</h3>
<p>Here we are going to add the title filter &ldquo;Broad.&rdquo; This setting prevents your ConfigMgr environment from downloading <em>all</em> different versions of the Defender Updates (there are a lot of them). On top of that, we are going to bypass all maintence windows here. These need to go out ASAP.</p>
<p><img src="/2026-01-05_07-47-25.PNG" alt="Image"></p>
<blockquote>
<p><strong>Where I see people go wrong:</strong>
Companies hear the word &ldquo;update&rdquo; and think &ldquo;reboot.&rdquo; That&rsquo;s not the case here. Send these all the time; better safe than sorry. Your Defender updates will not be noticed by anyone.</p>
</blockquote>
<hr>
<h2 id="4-third-party-updates">4. Third-Party Updates</h2>
<p><strong>Scope:</strong> Browsers, third-party software, anything that&rsquo;s not in the above ADRs.</p>
<h3 id="the-rings-when-3">The Rings (When)</h3>
<p>Split this into 3 groups:</p>
<ol>
<li><strong>Test</strong> - All Devices (0 day delay)</li>
<li><strong>Broad</strong> - All Devices (3 day delay)</li>
<li><strong>Production</strong> - All Devices (5 day delay)</li>
</ol>
<p><strong>Maintenance Windows:</strong> None. Send to everyone daily.</p>
<h3 id="frequency-3">Frequency</h3>
<p><strong>Run the ADR: Daily.</strong>
Vendors send updates whenever they feel like it. Keep your devices up to date.</p>
<h3 id="the-why-3">The &ldquo;Why&rdquo;</h3>
<p>Third-party updates <em>generally</em> do not require a reboot.
I say &ldquo;Generally&rdquo; because if the app is running and you attempt to run the MSI to update, it will throw the <code>3010</code> back to ConfigMgr. Use things like <strong>Manage Conflicting Processes</strong> (in PMPC) or <code>Show-InstallationWelcome</code> (PSADT). Additionally, You can suppress reboots in the deployment for servers if you are worried.</p>
<h3 id="additional-settings-3">Additional settings</h3>
<p>Here is where things git a bit tricky, we are going to add the &ldquo;IsDeployed=No&rdquo; flag and allow the ADR to create new SUGs every time. With these settings the ADRs will stagger themselves properly even if they overlap with updates. For example, if Chrome sends an update 3 days after the previous update (very common) the new Chrome update will not push out the old Chrome update out of the SUG. You will start to generate new SUGs every day new updates are released into the environment.</p>
<p><img src="/2025-12-29_21-17-48.PNG" alt="Image"></p>
<blockquote>
<p><strong>Where I see people go wrong:</strong>
&ldquo;Why send third-party updates to servers?&rdquo;
I can&rsquo;t tell you how many vendors try to install Chrome because they don&rsquo;t know how to bypass the IE security mode. This is bad. It shouldn&rsquo;t be there. But if, for some godforsaken reason, you need Chrome or any other client software on your Servers, <strong>they should be patched all the time!</strong>
Additionally, if you are using update rings, adding these to the same Software Update Group as OS updates can cause updates like Chrome to overlap, pushing out the delays so the last group never gets the update. Keep them separate.</p>
</blockquote>
<hr>
<h3 id="script-implementation">Script Implementation</h3>
<p>I created a script to give you a framework using the outlined ADRs above.
This is meant to be the structure in which you build your ADRs around. Every environment will have it&rsquo;s special requirements and considerations. You can modify the settings in ConfigMgr after the script is run in your environment.</p>
<p><a href="https://github.com/ckdalton01/BuildADRFramework/blob/main/BuildADRFramework.ps1">https://github.com/ckdalton01/BuildADRFramework/blob/main/BuildADRFramework.ps1</a></p>
<p><img src="/2026-01-05_12-49-32.PNG" alt="Image"></p>
<h2 id="features">Features</h2>
<ul>
<li><strong>Automated Infrastructure Setup</strong>: Creates all necessary collections, packages, and ADRs with a single command</li>
<li><strong>Phased Deployment Strategy</strong>: Test → Broad → Production deployment phases with configurable deadlines</li>
<li><strong>Multiple Update Categories</strong>: Separate ADRs for Windows OS, Office, Defender, and third-party updates</li>
<li><strong>Idempotent Operations</strong>: Safe to run multiple times - checks for existing objects before creating</li>
<li><strong>Easy Cleanup</strong>: Built-in <code>-Uninstall</code> switch to remove all created components</li>
</ul>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
