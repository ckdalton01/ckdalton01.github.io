<!doctype html>
<html lang="en-us">
  <head>
    <title>Intune App List &#43; Assignments // DaltonFarm0</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Chris Dalton" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Intune App List &#43; Assignments">
  <meta name="twitter:description" content="A customer recently reached out asking if we had a report that could grab every application created in Intune and display all the assignments associated with each one. At Patch My PC, we didn’t have a specific report for that exact scenario (at the time of this writing), so I decided to build a custom solution.
I figured it wouldn’t be too difficult to pull this data using PowerShell and the Microsoft Graph API. Below is the journey from a basic raw data dump to a polished Excel report.">

    <meta property="og:url" content="https://ckdalton01.github.io/blog/intuneapplist/">
  <meta property="og:site_name" content="DaltonFarm0">
  <meta property="og:title" content="Intune App List &#43; Assignments">
  <meta property="og:description" content="A customer recently reached out asking if we had a report that could grab every application created in Intune and display all the assignments associated with each one. At Patch My PC, we didn’t have a specific report for that exact scenario (at the time of this writing), so I decided to build a custom solution.
I figured it wouldn’t be too difficult to pull this data using PowerShell and the Microsoft Graph API. Below is the journey from a basic raw data dump to a polished Excel report.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2026-01-06T20:17:37-07:00">
    <meta property="article:modified_time" content="2026-01-06T20:17:37-07:00">
    <meta property="article:tag" content="Intune">
    <meta property="article:tag" content="GraphAPI">


  </head>
  <body>
    <header class="app-header">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Chris Dalton" /></a>
      <span class="app-header-title">DaltonFarm0</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             -- 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
             -- 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p>Professional Log Reader, amature at everything else.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/ckdalton01" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="https://www.linkedin.com/in/christopher-dalton-552a2955" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-linkedin" viewBox="0 0 24 24" fill="currentColor"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Intune App List &#43; Assignments</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Jan 6, 2026
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          4 min read
        </div>
        <div>
          <svg class="icon icon-tag" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
              <a class="tag" href="/tags/intune/">Intune</a>
              <a class="tag" href="/tags/graphapi/">GraphAPI</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>A customer recently reached out asking if we had a report that could grab every application created in Intune and display all the assignments associated with each one. At Patch My PC, we didn&rsquo;t have a specific report for that exact scenario (at the time of this writing), so I decided to build a custom solution.</p>
<p>I figured it wouldn&rsquo;t be too difficult to pull this data using PowerShell and the Microsoft Graph API. Below is the journey from a basic raw data dump to a polished Excel report.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before running these scripts, you will need the Microsoft Graph module installed. If you don&rsquo;t have it yet, you can run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Install-Module Microsoft.Graph -Scope CurrentUser
</span></span></code></pre></div><h1 id="v1">v1</h1>
<p>This was my initial attempt. The goal here was simply to get the data out. The script connects to Graph, retrieves all mobile apps, iterates through their assignments, and resolves the Group IDs to friendly Display Names.</p>
<p>Here is the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Connect-MgGraph -Scopes <span style="color:#e6db74">&#34;DeviceManagementApps.Read.All&#34;</span>,<span style="color:#e6db74">&#34;Group.Read.All&#34;</span>
</span></span><span style="display:flex;"><span>$apps = Get-MgDeviceAppManagementMobileApp -All
</span></span><span style="display:flex;"><span>$results = @()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($app <span style="color:#66d9ef">in</span> $apps) {
</span></span><span style="display:flex;"><span>    $assignments = Get-MgDeviceAppManagementMobileAppAssignment -MobileAppId $app.Id
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> ($assignment <span style="color:#66d9ef">in</span> $assignments) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $groupId = $null
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($assignment.Target.GroupId) {
</span></span><span style="display:flex;"><span>            $groupId = $assignment.Target.GroupId
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">elseif</span> ($assignment.Target.AdditionalProperties.groupId) {
</span></span><span style="display:flex;"><span>            $groupId = $assignment.Target.AdditionalProperties.groupId
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        $groupName = <span style="color:#66d9ef">if</span> ($groupId) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                (Get-MgGroup -GroupId $groupId -ErrorAction Stop).DisplayName
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;Group Not Found (</span>$groupId<span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;All Users / All Devices&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        $results += [<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>            AppName        = $app.DisplayName
</span></span><span style="display:flex;"><span>            AssignmentType = $assignment.Intent
</span></span><span style="display:flex;"><span>            GroupName      = $groupName
</span></span><span style="display:flex;"><span>            GroupId        = $groupId
</span></span><span style="display:flex;"><span>            IncludeExclude = $assignment.Target.<span style="color:#e6db74">&#39;@odata.type&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$results | Export-Csv <span style="color:#e6db74">&#34;.\Intune-App-Assignments.csv&#34;</span> -NoTypeInformation
</span></span></code></pre></div><p>The output gives you the raw data, but it looks a bit flat:
<img src="/2026-01-06_20-32-06.PNG" alt="Image"></p>
<h1 id="v2">v2</h1>
<p>The CSV method worked, but it wasn&rsquo;t exactly pretty, especially if you have apps with multiple assignments cluttering up the rows. I wanted something cleaner that consolidated the data.</p>
<p>This version requires the ImportExcel module to handle the formatting:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Install-Module ImportExcel -Scope CurrentUser
</span></span></code></pre></div><p>This script aggregates the assignments per app and formats the Excel sheet with text wrapping and auto-adjusted row heights for better readability:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Connect-MgGraph -Scopes <span style="color:#e6db74">&#34;DeviceManagementApps.Read.All&#34;</span>,<span style="color:#e6db74">&#34;Group.Read.All&#34;</span>
</span></span><span style="display:flex;"><span>$apps = Get-MgDeviceAppManagementMobileApp -All
</span></span><span style="display:flex;"><span>$appAssignments = @{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($app <span style="color:#66d9ef">in</span> $apps) {
</span></span><span style="display:flex;"><span>    $assignments = Get-MgDeviceAppManagementMobileAppAssignment -MobileAppId $app.Id
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    $assignmentList = @()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> ($assignment <span style="color:#66d9ef">in</span> $assignments) {
</span></span><span style="display:flex;"><span>        $groupId = $null
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($assignment.Target.GroupId) {
</span></span><span style="display:flex;"><span>            $groupId = $assignment.Target.GroupId
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">elseif</span> ($assignment.Target.AdditionalProperties.groupId) {
</span></span><span style="display:flex;"><span>            $groupId = $assignment.Target.AdditionalProperties.groupId
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Fun fact, the All Devices Group doesn&#39;t have a groupID associated with it</span>
</span></span><span style="display:flex;"><span>        $groupName = <span style="color:#66d9ef">if</span> ($groupId) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                (Get-MgGroup -GroupId $groupId -ErrorAction Stop).DisplayName
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;Group Not Found (</span>$groupId<span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;All Users / All Devices&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        $assignmentList += [<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>            Intent = $assignment.Intent
</span></span><span style="display:flex;"><span>            GroupName = $groupName
</span></span><span style="display:flex;"><span>            IncludeExclude = $assignment.Target.<span style="color:#e6db74">&#39;@odata.type&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Store in hashtable by app name</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">-not</span> $appAssignments.ContainsKey($app.DisplayName)) {
</span></span><span style="display:flex;"><span>        $appAssignments[$app.DisplayName] = [<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>            AppName = $app.DisplayName
</span></span><span style="display:flex;"><span>            CreatedDateTime = $app.CreatedDateTime
</span></span><span style="display:flex;"><span>            Assignments = $assignmentList
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Merge assignments if app name already exists</span>
</span></span><span style="display:flex;"><span>        $appAssignments[$app.DisplayName].Assignments += $assignmentList
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Build final output</span>
</span></span><span style="display:flex;"><span>$excelData = @()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($appName <span style="color:#66d9ef">in</span> $appAssignments.Keys | Sort-Object) {
</span></span><span style="display:flex;"><span>    $app = $appAssignments[$appName]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($app.Assignments.Count <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        $excelData += [<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>            AppName         = $app.AppName
</span></span><span style="display:flex;"><span>            CreatedDateTime = $app.CreatedDateTime
</span></span><span style="display:flex;"><span>            AssignmentCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            Assignments     = <span style="color:#e6db74">&#34;No Assignments&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Combine intent and group as paired lines</span>
</span></span><span style="display:flex;"><span>        $assignmentStrings = $app.Assignments | ForEach-Object { 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;</span>$($_.Intent)<span style="color:#e6db74"> -&gt; </span>$($_.GroupName)<span style="color:#e6db74">&#34;</span> 
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        $allAssignments = $assignmentStrings -join <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        $excelData += [<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>            AppName         = $app.AppName
</span></span><span style="display:flex;"><span>            CreatedDateTime = $app.CreatedDateTime
</span></span><span style="display:flex;"><span>            AssignmentCount = $app.Assignments.Count
</span></span><span style="display:flex;"><span>            Assignments     = $allAssignments
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$filePath = <span style="color:#e6db74">&#34;.\Intune-App-Assignments.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$excelData | Export-Excel -Path $filePath `
</span></span><span style="display:flex;"><span>    -AutoSize `
</span></span><span style="display:flex;"><span>    -FreezeTopRow `
</span></span><span style="display:flex;"><span>    -BoldTopRow `
</span></span><span style="display:flex;"><span>    -TableName <span style="color:#e6db74">&#34;IntuneApps&#34;</span> `
</span></span><span style="display:flex;"><span>    -TableStyle <span style="color:#e6db74">&#34;Medium2&#34;</span> `
</span></span><span style="display:flex;"><span>    -WorksheetName <span style="color:#e6db74">&#34;App Assignments&#34;</span> `
</span></span><span style="display:flex;"><span>    -AutoFilter
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$excel = Open-ExcelPackage -Path $filePath
</span></span><span style="display:flex;"><span>$worksheet = $excel.Workbook.Worksheets[<span style="color:#e6db74">&#34;App Assignments&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$assignmentsColumn = $worksheet.Dimension.<span style="color:#66d9ef">End</span>.Column
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ($row = <span style="color:#ae81ff">2</span>; $row <span style="color:#f92672">-le</span> $worksheet.Dimension.<span style="color:#66d9ef">End</span>.Row; $row++) {
</span></span><span style="display:flex;"><span>    $cell = $worksheet.Cells[$row, $assignmentsColumn]
</span></span><span style="display:flex;"><span>    $cell.Style.WrapText = $true
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    $lineCount = ([<span style="color:#66d9ef">regex</span>]::Matches($cell.Text, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">&#34;</span>)).Count + <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    $minHeight = $lineCount * <span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($worksheet.Row($row).Height <span style="color:#f92672">-lt</span> $minHeight) {
</span></span><span style="display:flex;"><span>        $worksheet.Row($row).Height = $minHeight
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$worksheet.Column($assignmentsColumn).Width = <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Close-ExcelPackage $excel -Show
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#34;Excel file created: </span>$filePath<span style="color:#e6db74">&#34;</span> -ForegroundColor Green
</span></span></code></pre></div><p>Now, the final result looks much more professional:
<img src="/2026-01-06_20-32-59.PNG" alt="Image"></p>
<p>I also published it here:
<a href="https://github.com/ckdalton01/Get-AllAppsAllAssignments">https://github.com/ckdalton01/Get-AllAppsAllAssignments</a></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
