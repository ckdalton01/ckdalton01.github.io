<!doctype html>
<html lang="en-us">
  <head>
    <title>Get DiscoveredAppsAllDevices // DaltonFarm0</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Chris Dalton" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Get DiscoveredAppsAllDevices">
  <meta name="twitter:description" content="Mastering Microsoft Intune Software Inventory: A Deep Dive into Automated Reporting Managing a fleet of devices in a modern enterprise environment often feels like trying to herd cats—especially when it’s time to figure out exactly what software is installed where. If you’re an IT administrator using Microsoft Intune, you know that while the data exists within the portal, getting a clean, holistic, and shareable report can be a surprisingly manual task.">

    <meta property="og:url" content="https://ckdalton01.github.io/blog/get-discoveredappsalldevices/">
  <meta property="og:site_name" content="DaltonFarm0">
  <meta property="og:title" content="Get DiscoveredAppsAllDevices">
  <meta property="og:description" content="Mastering Microsoft Intune Software Inventory: A Deep Dive into Automated Reporting Managing a fleet of devices in a modern enterprise environment often feels like trying to herd cats—especially when it’s time to figure out exactly what software is installed where. If you’re an IT administrator using Microsoft Intune, you know that while the data exists within the portal, getting a clean, holistic, and shareable report can be a surprisingly manual task.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2026-02-11T19:35:34-07:00">
    <meta property="article:modified_time" content="2026-02-11T19:35:34-07:00">
    <meta property="article:tag" content="Intune">
    <meta property="article:tag" content="Windows">


  </head>
  <body>
    <header class="app-header">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Chris Dalton" /></a>
      <span class="app-header-title">DaltonFarm0</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             -- 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
             -- 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p>Professional Log Reader, amature at everything else.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/ckdalton01" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="https://www.linkedin.com/in/christopher-dalton-552a2955" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-linkedin" viewBox="0 0 24 24" fill="currentColor"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Get DiscoveredAppsAllDevices</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Feb 11, 2026
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          5 min read
        </div>
        <div>
          <svg class="icon icon-tag" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
              <a class="tag" href="/tags/intune/">Intune</a>
              <a class="tag" href="/tags/windows/">Windows</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="mastering-microsoft-intune-software-inventory-a-deep-dive-into-automated-reporting">Mastering Microsoft Intune Software Inventory: A Deep Dive into Automated Reporting</h1>
<p><img src="/Get-DiscoveredApps.png" alt="Image"></p>
<p>Managing a fleet of devices in a modern enterprise environment often feels like trying to herd cats—especially when it&rsquo;s time to figure out exactly what software is installed where. If you&rsquo;re an IT administrator using Microsoft Intune, you know that while the data exists within the portal, getting a clean, holistic, and shareable report can be a surprisingly manual task.</p>
<p>To bridge this gap, I developed a PowerShell-based reporting tool: the <strong>Intune Software Inventory Report</strong>. This script automates the extraction of discovered application data and transforms it into a professional, multi-sheet Excel workbook.</p>
<p>In this post, we&rsquo;ll break down what the script does, how the underlying engine works, and why it&rsquo;s a necessary addition to your IT toolkit.
<a href="https://github.com/ckdalton01/Get-DiscoveredAppsAllDevices">https://github.com/ckdalton01/Get-DiscoveredAppsAllDevices</a></p>
<hr>
<h2 id="what-the-script-does">What the Script Does</h2>
<p>At its core, the script is a data bridge. It connects to the Microsoft Graph API, pulls every instance of a discovered app across your entire Intune tenant, and organizes that data into a format that humans (and managers) can actually read.</p>
<p>Rather than clicking through individual device records in the Intune console to see who has a specific version of a browser or a piece of legacy software, the script aggregates this information into two primary output files:</p>
<ul>
<li><code>Intune_DiscoveredApps_WithDevices.csv</code></li>
<li><code>Intune_Software_Inventory.xlsx</code></li>
</ul>
<hr>
<h2 id="the-final-output-structure">The Final Output Structure</h2>
<p>The script doesn&rsquo;t just dump a flat list—it categorizes the data into four distinct worksheets:</p>
<p><strong>Overview</strong> - A high-level dashboard showing total discovered applications, installation records, and retrieval errors.</p>
<p><strong>Applications</strong> - A summarized list of every unique application name and version found, along with installation counts.</p>
<p><strong>Installations</strong> - A granular view that maps application names and versions to the specific devices where they are installed.</p>
<p><strong>Errors</strong> - A dedicated log for any applications that encountered issues during the retrieval process, ensuring full transparency.</p>
<hr>
<h2 id="how-it-works-under-the-hood">How It Works: Under the Hood</h2>
<p>The script relies on two primary pillars: the <strong>Microsoft.Graph PowerShell SDK</strong> for data retrieval and the <strong>ImportExcel</strong> module for report generation.</p>
<h3 id="1-authentication-and-permissions">1. Authentication and Permissions</h3>
<p>Before the script can see your data, it must authenticate via Microsoft Graph. It requests specific, read-only permissions to adhere to the principle of least privilege:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>DeviceManagementApps.Read.All
</span></span><span style="display:flex;"><span>DeviceManagementManagedDevices.Read.All
</span></span></code></pre></div><h3 id="2-the-data-collection-pipeline">2. The Data Collection Pipeline</h3>
<p>The script performs a comprehensive sweep of the environment. It retrieves all discovered apps and their associated devices, streaming the raw data to a CSV file first to minimize the memory footprint on the local machine. This is particularly important for large environments where thousands of records might be processed.</p>
<h3 id="3-resiliency-and-rate-limiting">3. Resiliency and Rate Limiting</h3>
<p>One of the biggest challenges with the Graph API is <strong>throttling</strong>. If you send too many requests too quickly, the API will limit your connection. This script manages this through built-in retry logic and configurable delays:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$maxRetries  = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>$baseDelayMs = <span style="color:#ae81ff">300</span>
</span></span></code></pre></div><p>If a call fails, the script automatically retries up to five times with an exponential backoff, ensuring the reporting process is resilient even under heavy API load.</p>
<h3 id="4-excel-transformation">4. Excel Transformation</h3>
<p>Once the data is collected, the script uses the <code>ImportExcel</code> module to build the final report. This includes professional touches such as frozen header rows, auto-sized columns, and wrapped text for multi-line content—making the data easy to navigate without manual formatting.</p>
<hr>
<h2 id="why-you-would-want-to-use-it">Why You Would Want to Use It</h2>
<p>You might be wondering why to use a script instead of the built-in Intune reports. While Microsoft provides excellent tools, this automated approach offers several advantages for modern admins.</p>
<h3 id="version-proliferation-tracking">Version Proliferation Tracking</h3>
<p>In a large environment, you rarely have just one version of an app. You might have several different versions of a browser or utility tool across your fleet. This script groups these by name and version, allowing you to see exactly where your update laggards are located.</p>
<h3 id="audit-and-compliance-readiness">Audit and Compliance Readiness</h3>
<p>When auditors ask for a software inventory, they want a structured document. By generating a multi-sheet Excel workbook, you can provide a point-in-time snapshot of your environment&rsquo;s software footprint that is ready for review or archival.</p>
<h3 id="error-visibility">Error Visibility</h3>
<p>Standard reporting can sometimes hide &ldquo;missing&rdquo; data. By including an <strong>Errors</strong> worksheet, this script tells you exactly which applications couldn&rsquo;t be fully processed, allowing you to troubleshoot specific device or API issues rather than guessing why your numbers look off.</p>
<hr>
<h2 id="getting-started">Getting Started</h2>
<p>To run the script, ensure your environment meets the prerequisites and that you have the required modules installed.</p>
<h3 id="installation">Installation</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># Install the necessary modules</span>
</span></span><span style="display:flex;"><span>Install-Module Microsoft.Graph -Scope CurrentUser
</span></span><span style="display:flex;"><span>Install-Module ImportExcel -Scope CurrentUser
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Run the inventory script</span>
</span></span><span style="display:flex;"><span>.\Get-DiscoveredAppsAllDevices.ps1
</span></span></code></pre></div><p>The script can be found here: <a href="https://github.com/ckdalton01/Get-DiscoveredAppsAllDevices">https://github.com/ckdalton01/Get-DiscoveredAppsAllDevices</a></p>
<hr>
<h2 id="performance-considerations">Performance Considerations</h2>
<p>For large environments with thousands of applications, the script may take over <strong>30 minutes</strong> to complete. This is normal behavior—the script carefully manages API rate limits to ensure data integrity without triggering blocks.</p>
<hr>
<h2 id="summary">Summary</h2>
<p>In the world of modern management, data is only as good as your ability to analyze it. By moving your software inventory from the cloud into a structured, formatted Excel workbook, you gain the ability to filter, pivot, and share your device insights with ease.</p>
<p>Whether you&rsquo;re preparing for a security audit or just cleaning up your environment, this script provides the visibility you need to make informed decisions.</p>
<hr>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
